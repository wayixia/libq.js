function createAjaxTrans(){var t=null;try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(n){t=null}}return t||"undefined"==typeof XMLHttpRequest||(t=new XMLHttpRequest),t}function newAjax(t,e){var n=t||{},i=n.command.toString();i=-1==i.indexOf("?")?i+"?&rnd="+Q.rnd(16):i+"&rnd="+Q.rnd(16);var o=n.method||"POST";o=o.toString().toUpperCase(),"GET"==o||"POST"==o||(o="GET");var s=createAjaxTrans(),r=!0;n.async&&(r=!!n.async),s.open(o,i,r),n.withCredentials&&(s.withCredentials=!!n.withCredentials),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.onreadystatechange=function(){4==s.readyState&&(200==s.status?n.oncomplete&&n.oncomplete(s):n.onerror&&n.onerror(s))};var d=null;n.data&&"function"==typeof e&&(d=e(n.data)),s.send(d)}function fireMouseEvent(t,e){if(document.createEvent){var n=document.createEvent("MouseEvents");n.initEvent(e,!0,!1),t.dispatchEvent(n)}else document.createEventObject&&t.fireEvent("on"+e)}function $IsNull(t){return null==t}function $IsStyle(t,e){return Q.hasClass(t,e)}function register_hook(t){__GLOBALS.desktop.hook.append(t)}function unregister_hook(t){__GLOBALS.desktop.hook.erase(t)}function invoke_hook(t,e){__GLOBALS.desktop.hook.each(function(n){n(t,e)})}function $IsDesktopWindow(t){return __GLOBALS.desktop==t}function $IsWindow(t){return!$IsNull(t)&&t.nodeType==Q.ELEMENT_NODE&&t.getAttribute("__QWindow__")}function $IsMaxWindow(t){return $IsStyle(t,CONST.STYLE_MAX)&&CONST.SIZE_MAX==$GetWindowStatus(t)}function $BindWindowMessage(t,e,n){return function(){return t!=$GetDesktopWindow()?t.wnd_proc(t,e,n):!1}}function $MaskWindow(t,e){var n=$GetMask(t);$IsDesktopWindow(t)&&(e?(n.body_style=document.body.currentStyle.overflow,document.body.style.overflow="hidden"):document.body.style.overflow=n.body_style),n&&n.style&&(n.style.display=e?"":"none")}function $CreateMaskLayer(t,e){t.layer_mask=document.createElement("DIV"),t.layer_mask.body_style=document.body.currentStyle.overflow,t.layer_mask.className="q-window-mask alpha_1",e&&Q.addClass(t.layer_mask,e),t.appendChild(t.layer_mask),t.layer_mask.style.display="none",t.layer_mask.onmousedown=Q.bind_handler(t,function(t){return t=t||window.event,$BindWindowMessage(this,MESSAGE.ACTIVATE)(),t.cancelBubble=!0,!1}),t.layer_mask.onselectstart=function(){return!1}}function $ShowWindow(t,e){e?(t.style.display="",$BindWindowMessage(t,MESSAGE.ACTIVATE)()):(t.style.display="none",$MaskWindow(t,!1))}function $ActivateWindow(t,e){if($IsWindow(t)){var n=0;isNaN(e)||(n=e);var i=$GetContainerWindow(t);$SetActiveChild(i,t);var o=$GetTopZIndexWindow(i),s=$GetWindowZIndex(o)+1;$SetWindowZIndex(t,n?n:s),$SetWindowActive(o,!1),$SetWindowActive(t,!0)}}function $SetWindowActive(t,e){for(var n=t;n;)n.on_activate&&n.on_activate(e),e?Q.removeClass(n,CONST.inactive_title):Q.addClass(n,CONST.inactive_title),n=$GetActiveChild(n)}function $MaxizeWindow(t){if($GetWindowStatus(t)!=CONST.SIZE_MAX){var e,n,i=$GetContainerWindow(t);if(i==document.body){var o=Q.workspace();e=o.width,n=o.height}else{if(!$IsWindow(i))return;e=Math.max($GetClient(i).clientWidth,$GetClient(i).scrollWidth),n=Math.max($GetClient(i).clientHeight,$GetClient(i).scrollHeight)}$ChangeCtrlButton(t,CONST.SIZE_MAX,"q-normal"),$SetWindowPosition(t,0,0,e,n),$SetWindowStatus(t,CONST.SIZE_MAX)}}function $RestoreWindow(t){$ChangeCtrlButton(t,CONST.SIZE_MAX,"q-max"),$MoveTo(t,t.rleft,t.rtop),$ResizeTo(t,t.rwidth,t.rheight),$SetWindowStatus(t,CONST.SIZE_NORMAL)}function $MinimizeWindow(t){$GetWindowStatus(t)!=CONST.SIZE_MAX&&(t.minizing?($ResizeTo(t,t.nWidth,t.minizie_height),t.minizing=!1):(t.minizie_height=t.nHeight,$ResizeTo(t,t.nWidth,$GetTitle(t).offsetHeight),t.minizing=!0))}function $FitWindow(t){var e=$GetClient(t),n=e.style.overflow;e.style.overflow="visible";var i=e.scrollHeight;$IsStyle(t,CONST.no_title)||(i+=$GetTitle(t).offsetHeight),$IsStyle(t,CONST.with_bottom)&&(i+=$GetBottomBar(t).offsetHeight),$ResizeTo(t,e.scrollWidth,i),e.style.overflow=n}function $SetWindowPosition(t,e,n,i,o){$MoveTo(t,e,n),$ResizeTo(t,i,o)}function $SetWindowTitle(t,e){t.title_text=e,t.hTitle.hTitleContent.innerText=e}function $SetActiveChild(t,e){t.active_child=e}function $SetWindowZIndex(t,e){t!==$GetDesktopWindow()&&(t.style.zIndex=e)}function $RemoveWindowStyle(t,e){Q.removeClass(t,e)}function $SetWindowStatus(t,e){t.status_type=e}function $MoveTo(t,e,n){t.rtop=t.nTop,t.rleft=t.nLeft,t.nTop=n,t.nLeft=e,t.style.top=t.nTop+"px",t.style.left=t.nLeft+"px"}function $ResizeTo(t,e,n){t.rwidth=t.nWidth,t.rheight=t.nHeight,e=Math.max(parseInt(e,10)-0,__GLOBALS.MIN_WIDTH),n=Math.max(parseInt(n,10),__GLOBALS.MIN_HEIGHT),t.nWidth=e,t.nHeight=n,t.style.width=e+"px",t.style.height=n+"px","function"==typeof t.on_size&&t.on_size(e,n)}function $GetWindowClientHeight(){var t=0;return"number"==typeof window.innerHeight?t=window.innerHeight:document.documentElement&&document.documentElement.clientHeight?t=document.documentElement.clientHeight:document.body&&document.body.clientHeight&&(t=document.body.clientHeight),t}function $CenterWindow(t){var e=Q.scrollInfo(),n=e.l+(document.body.clientWidth-t.nWidth)/2,i=e.t+($GetWindowClientHeight()-t.nHeight)/2;$MoveTo(t,n,i)}function $SetWindowProc(t,e){if("function"==typeof e){var n=t.wnd_proc;return t.wnd_proc=e,n}return null}function $GetDesktopContainer(){return __GLOBALS.desktop}function $GetDesktopWindow(){return __GLOBALS.desktop}function $GetMask(t){return t.layer_mask}function $GetActiveChild(t){return t.active_child}function $GetContainerWindow(t){return t.container_wnd}function $GetParentWindow(t){return t.parent_wnd}function $GetWnds(t){return t.wnds}function $GetMinCtrlButton(t){return t.hTitle.hMin}function $GetMaxCtrlButton(t){return t.hTitle.hMax}function $GetTitleText(t){return t.title_text}function $GetTitleContent(t){return t.hTitleContent}function $GetTitle(t){return t.hTitle}function $GetBottomBar(t){return t.hBottomBar}function $GetWindowStatus(t){return t.status_type}function $GetWindowStyle(t){return t.className}function $GetClient(t){return t.hClientArea}function $GetWindowZIndex(t){return t&&t.style&&t.style.zIndex?parseInt(t.style.zIndex,10):__GLOBALS.Z_INDEX}function $GetTopZIndexWindow(){var t;t=arguments.length>0&&$IsWindow(arguments[0])?arguments[0]:$GetDesktopWindow();var e=$GetWnds(t),n=null;return e.each(function(t){return n?(top_zindex=$GetWindowZIndex(n),wnd_zindex=$GetWindowZIndex(t),wnd_zindex>top_zindex&&(n=t)):n=t,!0}),n}function $DefaultWindowProc(t,e){switch(e){case MESSAGE.CREATE:break;case MESSAGE.MIN:$MinimizeWindow(t);break;case MESSAGE.MAX:$GetWindowStatus(t)!=CONST.SIZE_MAX?$MaxizeWindow(t):$RestoreWindow(t);break;case MESSAGE.CLOSE:var n=!0;t.on_close&&(n=t.on_close()),n===!1?$ShowWindow(t,!1):$DestroyWindow(t);break;case MESSAGE.ACTIVATE:for(var i=$GetTopZIndexWindow($GetDesktopWindow()),o=$GetWindowZIndex(i),s=t;s&&s.modal_prev;)s=s.modal_prev;for(;s&&s.modal_next;)s=s.modal_next,++o;for($ActivateWindow(s,++o),s!=t&&$BindWindowMessage(s,MESSAGE.ACTIVATE)();s&&s.modal_prev;)s=s.modal_prev,$SetWindowZIndex(s,--o);break;case MESSAGE.MOVE:}return invoke_hook(t,e),!1}function $CreateCtrlButton(t){var e=document.createElement("button");return e.innerHTML="&nbsp;",e.className=t,e.hideFocus=!0,e}function $ChangeCtrlButton(t,e,n){var i;e==CONST.SIZE_MIN?i=$GetMinCtrlButton(t):e==CONST.SIZE_MAX&&(i=$GetMaxCtrlButton(t)),i.className=n}function $CreateWindowTitlebar(t){var e=document.createElement("DIV");e.className="q-title",e.onselectstart=function(){return!1},e.onclick=function(e,n){return function(){$IsStyle(n,CONST.fixed)||(e.clickonce?($BindWindowMessage(t,MESSAGE.MAX)(),e.clickonce=!1):e.clickonce=!0,setTimeout(function(){e.clickonce=!1},300))}}(e,t),e.hIcon=document.createElement("div"),e.hIcon.className="q-icon",e.appendChild(e.hIcon),e.hTitleContent=document.createElement("DIV"),e.hTitleContent.className="q-title-content",e.appendChild(e.hTitleContent),e.hMin=$CreateCtrlButton("q-min"),e.hMax=$CreateCtrlButton("q-max"),e.hClose=$CreateCtrlButton("q-close"),e.hPadding=$CreateCtrlButton("q-padding"),e.hMin.onclick=$BindWindowMessage(t,MESSAGE.MIN),e.hMax.onclick=$BindWindowMessage(t,MESSAGE.MAX),e.hClose.onclick=$BindWindowMessage(t,MESSAGE.CLOSE),e.appendChild(e.hPadding),e.appendChild(e.hClose),e.appendChild(e.hMax),e.appendChild(e.hMin),t.hTitle=e,t.appendChild(e)}function $CreateWindow(t,e,n,i,o,s,r,d){n=void 0!=n?(n+"").replace(/\|+/g," "):"";var a=null,u=null;$IsWindow(t)||(t=$GetDesktopWindow()),a=$GetDesktopWindow(),u=$GetDesktopWindow();var l=document.createElement("DIV");return l.setAttribute("__QWindow__",!0),l.parent_wnd=t,l.container_wnd=u,l.modal_next=null,l.model_prev=null,l.wnds=new Q.List,l.active_child=null,l.title_text=e||"untitled",l.status_type=CONST.SIZE_NORMAL,l.wnd_proc=$DefaultWindowProc,l.app=d||__GLOBALS.explorer,l.app.add_window(l),l.className="q-window",l.style.display="none",l.style.zIndex=__GLOBALS.Z_INDEX,isNaN(o)&&(o=0),isNaN(i)&&(i=0),isNaN(s)&&(s=300),isNaN(r)&&(r=300),l.rtop=l.nTop=o,l.rleft=l.nLeft=i,l.rwidth=l.nWidth=s,l.rheight=l.nHeight=r,l.style.top=o+"px",l.style.left=i+"px",l.style.width=s+"px",l.style.height=r+"px",$GetWnds(u).append(l),$MakeResizable(l),Q.addEvent(l,"mousedown",$BindWindowMessage(l,MESSAGE.ACTIVATE)),$CreateWindowTitlebar(l),$SetWindowTitle(l,l.title_text),l.hClientArea=document.createElement("DIV"),l.hClientArea.className="q-window-client",l.appendChild(l.hClientArea),l.hBottomBar=document.createElement("DIV"),l.hBottomBar.className="q-bottom-bar",l.appendChild(l.hBottomBar),$CreateMaskLayer(l),Q.addClass(l,n),$BindWindowMessage(l,MESSAGE.CREATE)(),a.appendChild(l),Q.drag({id:l,objects:[l.hTitle,l.hTitle.hTitleCtrlBar,l.hTitle.hTitleContent],onmove_begin:Q.bind_handler(l,function(t,e){$GetWindowStatus(this)!=CONST.SIZE_MAX&&l.on_move_begin&&l.on_move_begin(t,e)}),onmove:Q.bind_handler(l,function(t,e){$GetWindowStatus(this)!=CONST.SIZE_MAX&&$MoveTo(this,t,e)}),onmove_end:Q.bind_handler(l,function(t,e){$GetWindowStatus(this)!=CONST.SIZE_MAX&&l.on_move_end&&l.on_move_end(t,e)})}),l}function $DestroyWindow(t){var e=$GetWnds(t);e.each(function(t){return $BindWindowMessage(t,MESSAGE.CLOSE)(),!0});var n=$GetContainerWindow(t),i=$GetWnds(n);i.each(function(e){return $GetParentWindow(e)==t&&$BindWindowMessage(e,MESSAGE.CLOSE)(),!0}),i.erase(t),t.setAttribute("__QWindow",null),t.parentNode&&t.parentNode.removeChild(t),t=0;var o=$GetTopZIndexWindow(n);$IsNull(o)?$SetActiveChild(n,null):$IsWindow(o)?$BindWindowMessage(o,MESSAGE.ACTIVATE)():$BindWindowMessage(n,MESSAGE.ACTIVATE)()}function $MakeResizable(t){function e(e){e=e||window.event;var n=$GetWindowStatus(t);Q.printf("mousedown out"+n),n!=CONST.SIZE_MAX&&e.button==Q.LBUTTON&&t.style.cursor&&(Q.printf("mousedown in"+n),$SetWindowStatus(t,CONST.SIZE_RESIZING),t.setCapture?t.setCapture():window.captureEvents&&window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP))}function n(e){e=e||window.event;var n=$GetWindowStatus(t);n!=CONST.SIZE_MAX&&n==CONST.SIZE_RESIZING&&e.button==Q.LBUTTON&&(Q.printf("mouseup in "+n),$SetWindowStatus(t,CONST.SIZE_NORMAL),t.releaseCapture?t.releaseCapture():window.releaseEvents&&window.releaseEvents(Event.MOUSEMOVE|Event.MOUSEUP))}function i(e){e=e||window.event;var n=e.srcElement||e.target,i=$GetWindowStatus(t);if(!(i&CONST.SIZE_MAX||$IsStyle(t,CONST.fixed)||i==CONST.SIZE_MIN))if(i==CONST.SIZE_RESIZING){var f=e.screenX-a,_=e.screenY-u;l.indexOf("w")>-1?o+=f:l.indexOf("e")>-1&&(r+=f),l.indexOf("n")>-1?s+=_:l.indexOf("s")>-1&&(d+=_);var p=t.style;r-o>__GLOBALS.MIN_WIDTH&&(p.left=o+"px",p.width=r-o+"px"),d-s>__GLOBALS.MIN_HEIGHT&&(p.top=s+"px",p.height=d-s+"px"),$ResizeTo(t,p.offsetWidth,p.offsetHeight),a+=f,u+=_}else if(n==t){var m=void 0==e.offsetX?e.layerX:e.offsetX,v=void 0==e.offsetY?e.layerY:e.offsetY,y=t.currentStyle;w=parseInt(y.width,10),h=parseInt(y.height,10);var b=parseInt(y.left,10),g=parseInt(y.top,10);l=c>v?"n":h-v<c?"s":"",l+=c>m?"w":w-m<c?"e":"",l?(t.style.cursor=l+"-resize",o=b,s=g,r=o+w,d=s+h,a=e.screenX,u=e.screenY):t.style.cursor&&(t.style.cursor="")}else t.style.cursor=""}var o,s,r,d,a,u,l,c=11;Q.addEvent(document,"mousedown",e),Q.addEvent(document,"mouseup",n),Q.addEvent(document,"mousemove",i)}function qid(t,e){function n(t){for(var i=null,o=0;o<t.childNodes.length;o++){var s=t.childNodes[o];if(s.nodeType===Q.ELEMENT_NODE){if(s.getAttribute("q:id")==e){i=s;break}if(i=n(s))break}}return i}return n(t)}function find_item(t,e){if(!t)return null;for(var n=t.childNodes,i=0;i<n.length;i++){var o=n[i];if(e(o))return o;var s=find_item(o,e);if(s)return s}return null}!function(){if(window.undefined=window.undefined,window.Q)return void alert("conflict name for Q");var t=null,e={},n={},i=[];String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")},String.prototype.trim_left=function(){return this.replace(/(^\s*)/g,"")},String.prototype.trim_right=function(){return this.replace(/(\s*$)/g,"")},Object.create||(Object.create=function(t,e){function n(){}if("undefined"!=typeof e)throw"The multiple-argument version of Object.create is not provided";return n.prototype=t,new n});var o=function(){};o.prototype.extend=function(t){var e=this.prototype,n=function(){this.__init__.apply(this,arguments)};n.prototype=Object.create(e);for(var i in t)n.prototype[i]=t[i];return n.prototype.constructor=n,n.extend=e.extend,n},o.extend=function(t){return this.prototype.extend.call(this,t)},window.Q=o,o.ELEMENT_NODE=1,o.ELEMENT_TEXTNODE=3,o.LBUTTON=1,o.RBUTTON=2,o.MBUTTON=4,o.setDebug=function(e){t=e},o.printf=function(e){t&&t.nodeType===o.ELEMENT_NODE?(t.innerHTML+="<br/>"+e,t.scrollTop=t.scrollHeight):window.console&&window.console.log(e)},o.$=function(t){if("string"!=typeof t)return t;if(t&&t.nodeType===o.ELEMENT_NODE)return t;var n=e[t];return n&&null!==n.parentElement||(n=document.getElementById(t),n&&(e[t]=n)),n},o.bind_handler=function(t,e){return function(){return e.apply(t,arguments)}},o.addEvent=function(t,e,n,i){var s=o.$(t);s.addEventListener?s.addEventListener(e,n,!!i):s.attachEvent?s.attachEvent("on"+e,n):oTarget["on"+e]=n},o.removeEvent=function(t,e,n){obj=o.$(t),obj.removeEventListener?obj.removeEventListener(e,n,!1):obj.detachEvent?obj.detachEvent("on"+e,n):obj["on"+e]=null},o.addClass=function(t,e){for(var n=(t.className+" "+e).trim().split(/\s+/),i="",o={},s=0;s<n.length;s++)o[n[s]]=0;for(var r in o)i+=r+" ";return t.className=i.trim(),t},o.removeClass=function(t,e){for(var n=(t.className+"").split(/\s+/),i=(e+"").split(/\s+/),o=[],s=0;s<n.length;s++){for(var r=!1,d=0;d<i.length;d++)n[s]==i[d]&&(r=!0);r||o.push(n[s])}return t.className=o.join(" "),t},o.hasClass=function(t,e){for(var n=(t.className+" ").split(/\s+/),i=0;i<n.length;i++)if(n[i]==e)return!0;return!1},o.dblclick=function(t,e){t=o.$(t),o.addEvent(t,"click",function(t){return function(){return t.__clickonce__?(t.__clickonce__=!1,clearTimeout(t.t),e&&e(t)):(t.__clickonce__=!0,t.t=setTimeout(function(e){return function(){e.__clickonce__=!1,click&&click(t)}}(t),200)),!1}}(t))},o.locale_text=function(t,e){return e},o.set_locale_text=function(t){"function"==typeof t&&(o.locale_text=t)},o.absPosition=function(t){for(var e=t.offsetWidth,n=t.offsetHeight,i=t.offsetTop,o=t.offsetLeft;t=t.offsetParent;)i+=t.offsetTop,o+=t.offsetLeft;return{width:e,height:n,left:o,top:i}},o.absPositionEx=function(t){var e=t.getBoundingClientRect(),n=e.left+document.documentElement.scrollLeft,i=e.top+document.documentElement.scrollTop,o=e.width,s=e.height;return{width:o,height:s,left:n,top:i}},o.scrollInfo=function(){var t,e,n,i;return document.documentElement&&(document.documentElement.scrollTop||document.documentElement.scrollLeft)?(t=document.documentElement.scrollTop,e=document.documentElement.scrollLeft,n=document.documentElement.scrollWidth,i=document.documentElement.scrollHeight):document.body&&(t=document.body.scrollTop,e=document.body.scrollLeft,n=document.body.scrollWidth,i=document.body.scrollHeight),{t:t,l:e,w:n,h:i}},o.workspace=function(){var t=document.body.clientHeight;document.documentElement.clientHeight&&(t=document.documentElement.clientHeight);var e=document.body.clientWidth;return document.documentElement.clientWidth&&(e=document.documentElement.clientWidth),{width:e,height:t}},o.copy=function(t){var e={};for(var n in t)e[n]=t[n];return e},o.query=function(t){return n[t]},o.delayDOMReady=function(){for(;i.length>0;)i.shift()()},o.ready=function(t,e){var n=!e;n?i.push(t):i.unshift(t)},o.loadModule=function(t,e){var n=document.getElementsByTagName("head")[0],i=document.createElement("script");i.type="text/javascript",i.src=t,i.done=!1,i.onload=i.onreadystatechange=function(){this.done||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(this.done=!0,e(!0),this.onload=this.onreadystatechange=null,n.removeChild(this))},i.onerror=function(){this.onload=this.onreadystatechange=null,n.removeChild(this),e(!1)},n.appendChild(i)},o.agent=function(){return navigator.userAgent.toLowerCase()},o.isW3C=function(){return document.getElementById?!0:!1},o.isIE=function(){var t=o.agent();return-1!=t.indexOf("msie")&&-1==t.indexOf("opera")&&-1==t.indexOf("omniweb")},o.isOpera=function(){return-1!=o.agent().indexOf("opera")},o.isNS6=function(){return o.isW3C()&&"Netscape"==navigator.appName},o.isNS6()&&(HTMLElement.prototype.__defineGetter__("innerText",function(){return this.textContent}),HTMLElement.prototype.__defineSetter__("innerText",function(t){this.textContent=t}),HTMLElement.prototype.__defineGetter__("currentStyle",function(){return this.ownerDocument.defaultView.getComputedStyle(this,null)}),o.LBUTTON=0,o.MBUTTON=1);for(var s=location.search.slice(1).split("&"),r=0;r<s.length;r++){var d=s[r].split("=");n[d[0]]=d[1]}o.addEvent(window,"load",function(){o.delayDOMReady()})}(),Q.List=Q.extend({head:null,length:0,__init__:function(){},Node:function(t){this.next=null,this.prev=null,this.data=t},begin:function(){return this.head},end:function(){return null},size:function(){return this.length},item:function(){return this.current.data},each:function(t){if("function"==typeof t)for(var e=this.begin();e!=this.end()&&t(e.data);e=e.next);},append:function(t){var e=new this.Node(t);if(this.head){for(var n=this.head;n.next;)n=n.next;n.next=e,e.prev=n}else this.head=e;this.length++},erase:function(t){var e=this.find(t);e&&(e!=this.head?(e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev)):(this.head=e.next,e.next&&(e.next.prev=null)),delete e,this.length--)},clear:function(){for(var t=this.begin();t!=this.end();t=t.next)this.removeNode(t)},find:function(t){for(var e=this.begin();e!=this.end();e=e.next)if(e.data==t)return e;return null}}),Q.HashMap=Q.extend({base:null,length:0,index:0,__init__:function(){this.base=new Object},each:function(t){if("function"==typeof t)for(var e in this.base)if(0==t(this.base[e],e))break},item:function(t){return this.base[t]},add:function(t,e){this.base[t]=e,this.length++},remove:function(t){this.has(t)&&(delete this.base[t],this.length--)},clear:function(){var t=this;this.each(function(e,n){t.remove(n)}),this.length=0},push:function(t){this.base[this.index]=t,this.length++,this.index++},pop:function(){var t=this.base[this.dataIndex];return delete this.base[this.dataIndex],this.length--,t},find:function(t){var e=null;return this.each(function(n,i){return n==t?(e=i,0):void 0}),e},has:function(t){return!("undefined"==typeof this.base[t])}});var Tween={Linear:function(t,e,n,i){return n*t/i+e},Quad:{easeIn:function(t,e,n,i){return n*(t/=i)*t+e},easeOut:function(t,e,n,i){return-n*(t/=i)*(t-2)+e},easeInOut:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e}},Cubic:{easeIn:function(t,e,n,i){return n*(t/=i)*t*t+e},easeOut:function(t,e,n,i){return n*((t=t/i-1)*t*t+1)+e},easeInOut:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e}},Quart:{easeIn:function(t,e,n,i){return n*(t/=i)*t*t*t+e},easeOut:function(t,e,n,i){return-n*((t=t/i-1)*t*t*t-1)+e},easeInOut:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e}},Quint:{easeIn:function(t,e,n,i){return n*(t/=i)*t*t*t*t+e},easeOut:function(t,e,n,i){return n*((t=t/i-1)*t*t*t*t+1)+e},easeInOut:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e}},Sine:{easeIn:function(t,e,n,i){return-n*Math.cos(t/i*(Math.PI/2))+n+e},easeOut:function(t,e,n,i){return n*Math.sin(t/i*(Math.PI/2))+e},easeInOut:function(t,e,n,i){return-n/2*(Math.cos(Math.PI*t/i)-1)+e}},Expo:{easeIn:function(t,e,n,i){return 0==t?e:n*Math.pow(2,10*(t/i-1))+e},easeOut:function(t,e,n,i){return t==i?e+n:n*(-Math.pow(2,-10*t/i)+1)+e},easeInOut:function(t,e,n,i){return 0==t?e:t==i?e+n:(t/=i/2)<1?n/2*Math.pow(2,10*(t-1))+e:n/2*(-Math.pow(2,-10*--t)+2)+e}},Circ:{easeIn:function(t,e,n,i){return-n*(Math.sqrt(1-(t/=i)*t)-1)+e},easeOut:function(t,e,n,i){return n*Math.sqrt(1-(t=t/i-1)*t)+e},easeInOut:function(t,e,n,i){return(t/=i/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e}},Elastic:{easeIn:function(t,e,n,i,o,s){if(0==t)return e;if(1==(t/=i))return e+n;if(s||(s=.3*i),!o||o<Math.abs(n)){o=n;var r=s/4}else var r=s/(2*Math.PI)*Math.asin(n/o);return-(o*Math.pow(2,10*(t-=1))*Math.sin(2*(t*i-r)*Math.PI/s))+e},easeOut:function(t,e,n,i,o,s){if(0==t)return e;if(1==(t/=i))return e+n;if(s||(s=.3*i),!o||o<Math.abs(n)){o=n;var r=s/4}else var r=s/(2*Math.PI)*Math.asin(n/o);return o*Math.pow(2,-10*t)*Math.sin(2*(t*i-r)*Math.PI/s)+n+e},easeInOut:function(t,e,n,i,o,s){if(0==t)return e;if(2==(t/=i/2))return e+n;if(s||(s=.3*i*1.5),!o||o<Math.abs(n)){o=n;var r=s/4}else var r=s/(2*Math.PI)*Math.asin(n/o);return 1>t?-.5*o*Math.pow(2,10*(t-=1))*Math.sin(2*(t*i-r)*Math.PI/s)+e:o*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*i-r)*Math.PI/s)*.5+n+e}},Back:{easeIn:function(t,e,n,i,o){return void 0==o&&(o=1.70158),n*(t/=i)*t*((o+1)*t-o)+e},easeOut:function(t,e,n,i,o){return void 0==o&&(o=1.70158),n*((t=t/i-1)*t*((o+1)*t+o)+1)+e},easeInOut:function(t,e,n,i,o){return void 0==o&&(o=1.70158),(t/=i/2)<1?n/2*t*t*(((o*=1.525)+1)*t-o)+e:n/2*((t-=2)*t*(((o*=1.525)+1)*t+o)+2)+e}},Bounce:{easeIn:function(t,e,n,i){return n-Tween.Bounce.easeOut(i-t,0,n,i)+e},easeOut:function(t,e,n,i){return(t/=i)<1/2.75?7.5625*n*t*t+e:2/2.75>t?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOut:function(t,e,n,i){return i/2>t?.5*Tween.Bounce.easeIn(2*t,0,n,i)+e:.5*Tween.Bounce.easeOut(2*t-i,0,n,i)+.5*n+e}}};Q.Animate=Q.extend({func:null,bind:null,timer:null,begin:0,duration:0,max:0,__init__:function(t){var e=this;return e.func="Linear"!=t.tween&&Tween[t.tween]?Tween[t.tween][t.ease]?Tween[t.tween][t.ease]:Tween[t.tween].easeIn:Tween.Linear,e.bind=t.bind,e.duration=t.duration,e.max=t.max,e.begin=t.begin,this},play:function(){function t(){o>n?(n++,e.bind(Math.ceil(e.func(n,0,i,o))),e._timer=setTimeout(t,10)):e.bind(i)}var e=this,n=e.begin,i=e.max,o=e.duration;clearTimeout(e._timer),t()}}),this.JSON||(JSON={}),function(){function f(t){return 10>t?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var n,i,o,s,r,d=gap,a=e[t];switch(a&&"object"==typeof a&&"function"==typeof a.toJSON&&(a=a.toJSON(t)),"function"==typeof rep&&(a=rep.call(e,t,a)),typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";if(gap+=indent,r=[],"[object Array]"===Object.prototype.toString.apply(a)){for(s=a.length,n=0;s>n;n+=1)r[n]=str(n,a)||"null";return o=0===r.length?"[]":gap?"[\n"+gap+r.join(",\n"+gap)+"\n"+d+"]":"["+r.join(",")+"]",gap=d,o}if(rep&&"object"==typeof rep)for(s=rep.length,n=0;s>n;n+=1)i=rep[n],"string"==typeof i&&(o=str(i,a),o&&r.push(quote(i)+(gap?": ":":")+o));else for(i in a)Object.hasOwnProperty.call(a,i)&&(o=str(i,a),o&&r.push(quote(i)+(gap?": ":":")+o));return o=0===r.length?"{}":gap?"{\n"+gap+r.join(",\n"+gap)+"\n"+d+"}":"{"+r.join(",")+"}",gap=d,o}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,n){var i;if(gap="",indent="","number"==typeof n)for(i=0;n>i;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(t,e){var n,i,o=t[e];if(o&&"object"==typeof o)for(n in o)Object.hasOwnProperty.call(o,n)&&(i=walk(o,n),void 0!==i?o[n]=i:delete o[n]);return reviver.call(t,e,o)}var j;if(cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),Q.rnd=function(t){for(var e="",n="abcdef1234567890".split(""),i=0;t>i;i++)e+=""+n[Math.round(Math.random()*(n.length-1))];return e},Q.json2str=function(t){return JSON.stringify(t,function(t,e){return e})},Q.json_decode=function(t){return JSON.parse(t)},Q.json_encode=function(t){return JSON.stringify(t)},Q.ajaxc=function(t){newAjax(t,function(t){return"postdata="+encodeURIComponent(encodeURIComponent(Q.json2str(t)))})},Q.ajax=function(t){newAjax(t,function(t){var e=null;for(var n in t)e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n])+"&";return e})},function(t){var e,n=t.extend({capture_wnd:null,is_drag:!1,x:0,y:0,begin_left:0,begin_top:0,mousedown_Hanlder:null,mouseup_handler:null,mousemove_handler:null,is_moved:!1,timer:null,__init__:function(){var e=this;e.mousedown_hanlder=function(t){e._mousedown(t)},e.mouseup_handler=function(t){e._mouseup(t)},e.mousemove_handler=function(t){e._mousemove(t)},t.addEvent(document,"mousedown",e.mousedown_hanlder),t.addEvent(document,"mouseup",e.mouseup_handler)},attach_object:function(e){var n=e||{},i=t.$(n.id),n=n||{};i.setAttribute("q-drag-object",!0),i.q_drag_objects=new t.List,i.q_onmove_begin=n.onmove_begin||function(){},i.q_onmove_end=n.onmove_end||function(){},i.q_onmove=n.onmove||function(t,e){var n=this;n.style.left=t+"px",n.style.top=e+"px"},n.self&&this.add_drag_handler(i,i);for(var o=n.objects||[],s=0;s<o.length;s++)this.add_drag_handler(i,t.$(o[s]))},deattach_object:function(e){var n=t.$(e);n.removeAttribute("q-drag-object")},add_drag_handler:function(t,e){t.q_drag_objects.append(e)},remove_drag_handler:function(t,e){t.q_drag_objects.erase(e)},is_drag_handler:function(t,e){return this.is_dragable(t)&&t.q_drag_objects.find(e)},is_dragable:function(e){var n=t.$(e);return n&&n.getAttribute&&!!n.getAttribute("q-drag-object")},zoom:function(t){return this.capture_wnd&&this.capture_wnd.style.zoom?t/(1*this.capture_wnd.style.zoom):t},_mousedown:function(e){if(e=e||window.event,e.button!=t.RBUTTON){for(var n=drag_handle=t.isNS6()?e.target:e.srcElement;n&&!this.is_dragable(n)&&n!=document.body;)n=n.parentNode;return n&&this.is_drag_handler(n,drag_handle)?(this.capture_wnd=n,this.is_drag=!0,this.x=e.clientX,this.y=e.clientY,this.begin_left=n.offsetLeft,this.begin_top=n.offsetTop,this.capture_wnd.q_onmove_begin&&this.capture_wnd.q_onmove_begin(this.begin_left+this.zoom(this.x),this.begin_top+this.zoom(this.y)),this.timer=setTimeout(t.bind_handler(this,function(){t.addEvent(document,"mousemove",this.mousemove_handler)}),10),!1):void 0}},_mousemove:function(t){if(this.is_moved=!0,t=t||window.event,this.is_drag){var e=t.clientX-this.x,n=t.clientY-this.y;return this.capture_wnd.q_onmove(this.begin_left+this.zoom(e),this.begin_top+this.zoom(n)),!1}},_mouseup:function(){clearTimeout(this.timer),this.is_drag&&(this.is_drag=!1,t.removeEvent(document,"mousemove",this.mousemove_handler),this.capture_wnd.q_onmove_end&&this.capture_wnd.q_onmove_end(this.zoom(this.x),this.zoom(this.y))),this.is_moved=!1}});t.drag=function(t){e||(e=new n),e.attach_object(t)},t.dragno=function(t){e&&e.deattach_object(t)}}(window.Q);var MENU_SEPERATOR="seperator",MENU_ITEM="item",MENU_ITEM_CHECKBOX="checkbox",MENU_ITEM_RADIO="radio";Q.MenuItem=Q.extend({hwnd:null,parentMenu:null,topMenu:null,titlewnd:null,subwnd:null,iconwnd:null,activeItem:null,type:-2,isAjust:!1,clickHidden:!0,items:null,data:null,isChecked:!0,popup_style:null,__init__:function(t){t=t||{};var e=this;e.items=[],e.parentMenu=t.parentMenu,e.data=t.data,this.popup_style=t.popup_style,this.type=t.type||MENU_ITEM,e.hwnd=document.createElement("LI"),e.titlewnd=document.createElement("DIV"),e.hwnd.appendChild(e.titlewnd),t.type==MENU_SEPERATOR?(e.hwnd.className="q-item-seperator",e.titlewnd.className="q-line"):(e.hwnd.className="q-item",e.titlewnd.className="q-item-title",e.iconwnd=document.createElement("button"),e.iconwnd.className="q-item-icon",e.iconwnd.innerHTML="&nbsp;",e.titlewnd.appendChild(e.iconwnd),e.titlewnd.appendChild(document.createTextNode(t.text+"    ")),t.icon&&(e.iconwnd.style.background=t.icon),e.hwnd.onmouseover=function(t){if(t=t||event,e.parentMenu){var n=e.parentMenu.activeItem;n&&n.hidePopup()}e.parentMenu.activeItem=e,e.showPopup()},e.hwnd.onmouseout=function(t){t=t||event,Q.hasClass(e.hwnd,"q-active")||e.hidePopup()},e.hwnd.onmousedown=function(){return function(){Q.printf("menu onmousedown")}}(this,t),e.hwnd.onmouseup=function(t,e){return function(n){if(Q.printf("menu onmouseup"),n=n||window.event,!t.subwnd){var i=function(){};"function"==typeof e&&(i=e);var o=i(t);return void 0!==o&&o===!1?!1:(t.topMenu&&t.topMenu.hide(),!0)}}}(this,t.callback)),e.hwnd.oncontextmenu=function(){return!1},e.hwnd.onselectstart=function(){return!1}},addSubMenuItem:function(t){this.type!=MENU_SEPERATOR&&this.type!=MENU_ITEM_CHECKBOX&&(this.subwnd||(this.subwnd=document.createElement("DIV"),document.body.appendChild(this.subwnd),this.subwnd.className="q-contextmenu",this.popup_style&&Q.addClass(this.subwnd,this.popup_style),Q.addClass(this.hwnd,"q-more"),this.subwnd.onmousedown=function(t){t=t||event},this.subwnd.oncontextmenu=function(){return!1}),this.subwnd.appendChild(t.hwnd),t.parentMenu=this,t.setTopMenu(this.topMenu),this.items.push(t))},setTopMenu:function(t){this.topMenu=t;for(var e=this.items.length,n=0;e>n;n++)this.items[n].setTopMenu(t)},hidePopup:function(){if(this.subwnd){Q.removeClass(this.hwnd,"q-active"),this.activeItem&&(this.activeItem=null),this.subwnd.style.display="none";for(var t=this.items.length,e=0;t>e;e++)this.items[e].hidePopup()}},showPopup:function(){if(this.subwnd){Q.addClass(this.hwnd,"q-active"),this.subwnd.style.display="";var t=Q.workspace(),e=Q.absPositionEx(this.hwnd),n=0,i=0;e.top+e.height+this.subwnd.offsetHeight>t.height?(i=e.top+e.height-this.subwnd.offsetHeight,0>i&&(i=0)):i=e.top,this.subwnd.offsetWidth+e.left+e.width>t.width?(n=e.left-this.subwnd.offsetWidth,0>n&&(n=0)):n=e.left+e.width;var o=Q.scrollInfo();this.subwnd.style.left=o.l+n+"px",this.subwnd.style.top=o.t+i+"px"}},data:function(){return this.data}}),Q.Menu=Q.extend({hwnd:null,subwnd:null,timer:null,isajust:!1,activeItem:null,items:null,_fHide:null,_fWheel:null,_fOnPopup:null,__init__:function(t){t=t||{};this.items=[],this._fHide=function(t,e){return function(t){t=t||window.event;

for(var n=Q.isNS6()?t.target:t.srcElement;n&&!Q.hasClass(n,"q-contextmenu")&&n!=document.body;)n=n.parentNode;return n&&n!=document.body?(t.returnValue=!1,!1):void e()}}(this,Q.bind_handler(this,this.hide)),this._fOnPopup="function"==typeof t.on_popup?t.on_popup:function(){},this.initview(t)},initview:function(t){this.hwnd=document.createElement("DIV"),this.hwnd.className="q-contextmenu",document.body.appendChild(this.hwnd),Q.addClass(this.hwnd,t.style)},addMenuItem:function(t){var e=this;e.hwnd.appendChild(t.hwnd),t.parentMenu=e,t.setTopMenu(e),e.items.push(t)},show:function(t){var e=this,n=Q.scrollInfo(),i=0,o=0;if(t=t||window.event,e.hwnd.style.display="",i=t.clientX+e.hwnd.offsetWidth>document.body.clientWidth?t.clientX+n.l-e.hwnd.offsetWidth-2:t.clientX+n.l,o=t.clientY+e.hwnd.offsetHeight>document.body.clientHeight?t.clientY+n.t-e.hwnd.offsetHeight-2:t.clientY+n.t,e.hwnd.style.left=i+"px",e.hwnd.style.top=o+"px",this._fWheel=document.onmousewheel,document.onmousewheel=function(){return!1},!e.isajust){e.isajust=!0;for(var s=e.hwnd.childNodes,r=s.length,d=0;r>d;d++){var a=s[d];a.style.width=e.hwnd.offsetWidth-2+"px"}}Q.addEvent(window,"blur",e._fHide),Q.addEvent(window,"resize",e._fHide),Q.addEvent(document,"mouseup",e._fHide)},showElement:function(t){var e=this;if(e.hide(),Q.addEvent(document,"mousedown",e._fHide),Q.addEvent(window,"blur",this._fHide),this._fOnPopup(!0),t.nodeType==Q.ELEMENT_NODE){if(e.hwnd.style.display="",!this.isajust){this.isajust=!0;for(var n=this.hwnd.childNodes,i=n.length,o=0;i>o;o++){var s=n[o];s.style.width=e.hwnd.offsetWidth-2+"px"}}var r=Q.workspace(),d=Q.absPosition(t),a=0,u=0;u=d.top+d.height+e.hwnd.offsetHeight>r.height?d.top-e.hwnd.offsetHeight:d.top+d.height,a=e.hwnd.offsetWidth+d.left>r.width?d.left+d.width-e.hwnd.offsetWidth:d.left;var l=Q.scrollInfo();e.hwnd.style.left=l.l+a+"px",e.hwnd.style.top=l.t+u+"px"}},hide:function(){this.hwnd.style.display="none",Q.removeEvent(window,"blur",this._fHide),Q.removeEvent(document,"mousedown",this._fHide),document.onmousewheel=this._fWheel,this._fOnPopup(!1);for(var t=this.items.length,e=0;t>e;e++)this.items[e].hidePopup()}}),Q.MenuBar=Q.extend({focus:null,items:null,__init__:function(t){t=t||{},this.items=new Q.List,this._hide=Q.bind_handler(this,function(){Q.printf("blur"),Q.removeEvent(document,"mousedown",this._hide),Q.removeEvent(window,"blur",this._hide),this.focus=!1})},append:function(t,e){t._menu=e,t.onmousedown=function(t,e,n){return function(i){return Q.printf("mousedown item"),i=i||window.event,t.focus?(t._hide(),n&&n.hide()):(fireMouseEvent(document.body,"mousedown"),t.focus=!0,Q.addEvent(document,"mousedown",t._hide),Q.addEvent(window,"blur",t._hide),n&&n.showElement(e)),i.cancelBubble=!0,!0}}(this,t,e),t.onmouseover=function(t,e){return function(){Q.printf("item onmouseover"),t.focus&&t.focus_item(e)}}(this,t,e),this.items.append(t)},focus_item:function(t){this.items.each(function(e){return t!=e?e._menu&&e._menu.hide():e._menu&&e._menu.showElement(e),!0})}});var CONST={no_title:"q-attr-no-title",no_icon:"q-attr-no-icon",no_min:"q-attr-no-min",no_max:"q-attr-no-max",no_close:"q-attr-no-close",with_bottom:"q-attr-with-bottom",fixed:"q-attr-fixed",inactive_title:"q-attr-inactive-title",SIZE_MIN:"min",SIZE_MAX:"max",SIZE_NORMAL:"normal",SIZE_RESIZE:3,SIZE_DRAGING:4,SIZE_RESIZING:5,SIZE_MINING:6,IDCANCEL:"0",IDOK:"1",IDNO:"2"},__GLOBALS={};__GLOBALS.MIN_HEIGHT=30,__GLOBALS.MIN_WIDTH=100,__GLOBALS.Z_INDEX=1e4,__GLOBALS.count=0,__GLOBALS.appid=-1,__GLOBALS.apps={},Q.ready(function(){__GLOBALS.desktop=document.body,__GLOBALS.desktop.hook=new Q.List,__GLOBALS.desktop.wnds=new Q.List,__GLOBALS.desktop.active_child=null,__GLOBALS.explorer=new Q.UIApplication,$CreateMaskLayer(__GLOBALS.desktop,"q-top-mask")},!0),Q.Application=Q.extend({id:-1,__init__:function(){this.id=++__GLOBALS.appid,__GLOBALS.apps[this.id]=this},end:function(){delete __GLOBALS.apps[this.id]}}),Q.UIApplication=Q.Application.extend({wnds_map:null,__init__:function(){Q.Application.prototype.__init__.call(this,arguments),this.wnds_map=new Q.List},add_window:function(t){this.wnds_map.append(t)},erase_window:function(t){this.wnds_map.erase(t)},end:function(){this.wnds_map.each(function(t){delete t.app,t.on_close=function(){return!0},$BindWindowMessage(t,MESSAGE.CLOSE)()}),Q.Application.prototype.end.call(this)}});var MESSAGE={CREATE:0,MIN:1,MAX:2,CLOSE:3,ACTIVATE:4,MOVE:5};Q.Window=Q.extend({hwnd:null,__init__:function(t){t=t||{};var e=t.title||"not",n=t.left||0,i=t.top||0,o=t.width||600,s=t.height||400,r=$GetDesktopWindow();t.parent instanceof Q.Window&&(r=t.parent.wnd()||$GetDesktopWindow()),this.hwnd=$CreateWindow(r,e,t.wstyle,n,i,o,s,t.app),this.setContent(t.content),this.hwnd.on_size=Q.bind_handler(this,t.on_size||function(){}),this.hwnd.on_activate=Q.bind_handler(this,t.on_activate||function(){}),this.hwnd.on_move_begin=Q.bind_handler(this,t.on_move_begin||function(){}),this.hwnd.on_move=Q.bind_handler(this,t.on_move||function(){}),this.hwnd.on_move_end=Q.bind_handler(this,t.on_move_end||function(){}),this.hwnd.on_close=Q.bind_handler(this,t.on_close||function(){return!0}),Q.bind_handler(this,t.on_create||function(){})()},wnd:function(){return this.hwnd},setWindowProc:function(t){return $SetWindowProc(this.hwnd,t)},setZIndex:function(t){$SetWindowZIndex(this.hwnd,t)},setContent:function(t){t=t||"",t&&t.nodeType==Q.ELEMENT_NODE?($GetClient(this.hwnd).appendChild(t),t.style.display=""):$GetClient(this.hwnd).innerHTML=t},addStyle:function(t){Q.addClass(this.hwnd,t)},removeStyle:function(t){Q.removeClass(this.hwnd,t)},show:function(t){$ShowWindow(this.hwnd,t)},center:function(){$CenterWindow(this.hwnd)},activate:function(){$BindWindowMessage(this.hwnd,MESSAGE.ACTIVATE)()},adjust:function(){$FitWindow(this.hwnd)},item:function(t){return qid($GetClient(this.hwnd),t)}}),Q.Dialog=Q.Window.extend({old_window_proc:null,__init__:function(t){t=t||{},t.wstyle=t.wstyle,t.wstyle+="|"+CONST.fixed,t.wstyle+="|"+CONST.no_min,t.wstyle+="|"+CONST.no_max;var e=[];t.buttons instanceof Array&&(t.wstyle+="|"+CONST.with_bottom,e=t.buttons),Q.Window.prototype.__init__.call(this,t),this.old_window_proc=this.setWindowProc(function(t){return function(e,n,i){return t.window_proc(n,i)}}(this));for(var n=0;n<e.length;n++){var i=e[n],o=i.style||"sysbtn";this.addBottomButton(i.text,o,function(t,e){return function(){e.onclick()&&t.end()}}(this,i))}},window_proc:function(t,e){switch(t){case MESSAGE.CLOSE:this.hwnd.modal_prev&&($MaskWindow(this.hwnd.modal_prev,!1),this.hwnd.modal_prev.modal_next=null,this.hwnd.modal_prev=null)}return this.old_window_proc(this.hwnd,t,e)},addBottomButton:function(t,e,n){$GetWindowStyle(this.hwnd);if(!$IsStyle(this.hwnd,CONST.with_bottom)||$IsNull($GetBottomBar(this.hwnd)))return!1;var i=document.createElement("button");return $GetBottomBar(this.hwnd).appendChild(i),i.innerText=t,i.onclick=n,i.className=e,!0},domodal:function(t){$IsWindow(t)||(t=$GetActiveChild($GetDesktopWindow()),$IsWindow(t)||(t=$GetDesktopWindow())),$MaskWindow(t,!0),t.modal_next=this.hwnd,this.hwnd.modal_prev=t,this.show(!0),$ResizeTo(this.hwnd,this.hwnd.nWidth,this.hwnd.nHeight),this.center(),$IsDesktopWindow(t)&&this.setZIndex(100001)},end:function(){return $BindWindowMessage(this.hwnd,MESSAGE.CLOSE)(),arguments.length>1?arguments[1]:CONST.IDCANCEL}}),Q.alert=function(t){var e=Q.Dialog.extend({__init__:function(t){t=t||{},t.width=t.width||360,t.height=t.height||200,t.buttons=[],t.on_ok=t.on_ok||function(){return!0},"function"==typeof t.on_ok&&(this.on_ok=t.on_ok,t.buttons.push({text:Q.locale_text("qYes"," 是 "),onclick:Q.bind_handler(this,function(){this.on_ok()&&this.end(CONST.IDOK)})})),"function"==typeof t.on_no&&(this.on_no=t.on_no,t.buttons.push({text:Q.locale_text("qNo"," 否 "),style:"syscancelbtn",onclick:Q.bind_handler(this,function(){this.on_no()&&this.end(CONST.IDNO)})})),"function"==typeof t.on_cancel&&(this.on_cancel=t.on_cancel,t.buttons.push({text:Q.locale_text("qCancel"," 取消 "),style:"syscancelbtn",onclick:Q.bind_handler(this,function(){this.on_cancel()&&this.end(CONST.IDCANCEL)})})),Q.Dialog.prototype.__init__.call(this,t),this.domodal()}});return new e(t)},Q.UI=Q.extend({ui_iframe:null,__init__:function(t){t=t||{},this.ui_iframe=document.createElement("IFRAME"),this.ui_iframe.src=t.src,this.ui_iframe.onload=function(){t.oncomplete(!0)},this.ui_iframe.onerror=function(){t.oncomplete(!1),document.body.removeChild(this)},this.ui_iframe.style.display="none",this.ui_iframe.src=t.src,document.body.appendChild(this.ui_iframe)},template:function(t){var e=this.ui_iframe.contentDocument||this.ui_iframe.contentWindow.document,n=e.getElementById(t);return n?n.cloneNode(!0):null},bindCss:function(){for(var t=document.getElementsByTagName("head"),e=this.ui_iframe.contentDocument||this.ui_iframe.contentWindow.document,n=0;n<e.styleSheets.length;n++){var i=e.styleSheets[n];if(!i)return;var o;if(""==i.ownerNode.innerHTML&&i.href)o=document.createElement("link"),o.setAttribute("type","text/css"),o.setAttribute("rel","stylesheet"),o.setAttribute("href",i.href);else{var s=i.ownerNode.innerHTML;if(o=document.createElement("style"),o.setAttribute("type","text/css"),o.styleSheet)o.styleSheet.cssText=s;else{var r=e.createTextNode(s);o.appendChild(r)}}t.length?t[0].appendChild(o):document.documentElement.appendChild(o)}}}),Q.Slider=Q.extend({min:0,max:100,value:0,duration:1,hwnd:null,thumb:null,__init__:function(t){var e=this;t=t||{},this.type="vt"==t.type?"vt":"hr",this.min=t.min,this.max=t.max,this.duration=t.duration||1,this.value=t.value?t.value:0,"function"==typeof t.on_xscroll&&(this.on_xscroll=t.on_xscroll),"function"==typeof t.on_yscroll&&(this.on_yscroll=t.on_yscroll),this.hwnd=Q.$(t.id),this.thumb=find_item(this.hwnd,function(t){return t&&t.nodeType==Q.ELEMENT_NODE&&t.className.indexOf("q-thumb")>=0}),this.thumb&&(Q.drag({id:this.thumb,self:!0,onmove:function(t,n){"hr"!=e.type?(0>n&&(n=0),n>e.hwnd.offsetHeight-e.thumb.offsetHeight&&(n=e.hwnd.offsetHeight-e.thumb.offsetHeight),e.value=Math.floor(e.min+1*(e.max-e.min)*n/(e.hwnd.offsetHeight-e.thumb.offsetHeight)),e.on_yscroll(e.value),e.thumb.style.top=n+"px"):(0>t&&(t=0),t>e.hwnd.offsetWidth-e.thumb.offsetWidth&&(t=e.hwnd.offsetWidth-e.thumb.offsetWidth),e.value=Math.floor(e.min+1*(e.max-e.min)*t/(e.hwnd.offsetWidth-e.thumb.offsetWidth)),e.on_xscroll(e.value),e.thumb.style.left=t+"px")}}),e.setValue(t.value))},getValue:function(){return this.value},setValue:function(t){var e=this;e.value=t>e.max?e.max:t<e.min?e.min:t;var n=1*(e.value-e.min)/(e.max-e.min);if("hr"!=e.type){var i=Math.floor(n*(e.hwnd.offsetHeight-e.thumb.offsetHeight));e.on_yscroll(e.value),e.thumb.style.top=i+"px"}else{var o=Math.floor(n*(e.hwnd.offsetWidth-e.thumb.offsetWidth));e.on_xscroll(e.value),e.thumb.style.left=o+"px"}},on_xscroll:function(){},on_yscroll:function(){}}),Q.CheckBox=Q.extend({hwnd:null,__init__:function(t){t=t||{},this.hwnd=Q.$(t.id),this.onchange=t.onchange||function(){},this.setCheck(!!t.checked),this.hwnd.onclick=function(t){return function(){t.setCheck(!t.checked())}}(this)},checked:function(){return Q.hasClass(this.hwnd,"checked")},setCheck:function(t){this.checked()!=t&&(t?Q.addClass(this.hwnd,"checked"):Q.removeClass(this.hwnd,"checked"),this.onchange(t))}});var BindAsEventHandler=function(t,e){return function(n){return e.call(t,n||window.event)}};Q.Store=Q.extend({records:null,proxy:null,currentpage:-1,__init__:function(t){t=t||{},this.records=new Q.HashMap,t.data&&this.appendData(t.data),t.proxy&&(this.proxy=t.proxy,this.loadRemote(0,30,null))},clear:function(){this.records=new Q.HashMap},appendData:function(t){for(var e=0;e<t.length;e++)this.push(t[e])},loadRemote:function(t,e,n){var i=this;Q.Ajax({command:i.proxy+"&page="+t+"&size="+e,oncomplete:function(t){var e=Q.json_decode(t.responseText);"function"==typeof n&&n(e.data)}})},loadPage:function(t,e,n){var i=n||function(){},o=this;if(o.proxy)o.loadRemote(t,e,i);else{for(var s=new Q.HashMap,r=(t-1)*e;t*e>r&&!(r>=o.records.length);r++)s.push(o.records.item(r));i(s)}},push:function(t){var e=this;t.__dataindex__=e.records.index,e.records.push(t)},remove:function(t){var e=this.records.find(t);this.records.remove(e)},each:function(t){this.records.each(t)},item:function(t){return this.records[t]}});var __TH=Q.extend({hwnd:null,hwnd_moveline:null,_width:0,_fMove:null,_fStop:null,_isResizable:!1,_isDragable:!1,_left:0,_right:0,_dx:5,__init__:function(t,e){e=e||{},this.onMove=e.onMove||function(){},this.onStart=e.onStart||function(){},this.onStop=e.onStop||function(){},this.hwnd=t,this._width=t.offsetWidth,this.hwnd_moveline=e.moveline,this.hwnd_moveline.style.display="none",this._fMove=BindAsEventHandler(this,this.Move),this._fStop=BindAsEventHandler(this,this.Stop),Q.addEvent(this.hwnd,"mousedown",BindAsEventHandler(this,this.Start)),Q.addEvent(this.hwnd,"mousemove",BindAsEventHandler(this,this.Move))},Start:function(t){var e=Q.absPosition(this.hwnd);this.hwnd.style.cursor&&(this._isResizable=!0,this._dx=e.left+e.width-t.clientX,this.hwnd_moveline.style.display="",this.hwnd_moveline.style.left=t.clientX+"px",this.hwnd_moveline.style.top=e.top+"px"),Q.addEvent(document,"mousemove",this._fMove),Q.addEvent(document,"mouseup",this._fStop),document.all?(Q.addEvent(this.hwnd,"losecapture",this._fStop),this.hwnd.setCapture()):(Q.addEvent(window,"blur",this._fStop),t.preventDefault()),this.onStart(t,this)},Move:function(t){var e=Q.scrollInfo();if(this._isDragable);else if(this._isResizable){if(this._left>t.clientX)return void(this.hwnd_moveline.style.left=this._left+"px");this.hwnd_moveline.style.left=t.clientX+"px"}else{var n=Q.absPosition(this.hwnd);this._left=n.left,this._right=n.left+n.width;var i=t.clientX-e.l;this.hwnd.style.cursor=i<=this._right+3&&i>=this._right-5?"col-resize":""}this.onMove(t,this)},Stop:function(t){this.hwnd_moveline.style.display="none",this._isResizable&&(this._width=t.clientX-this._left+this._dx,this.hwnd.firstChild.style.width=this._width+"px"),this._isDragable,this.onStop(t,this),Q.removeEvent(document,"mousemove",this._fMove),Q.removeEvent(document,"mouseup",this._fStop),document.all?(Q.removeEvent(this.hwnd,"losecapture",this._fStop),this.hwnd.releaseCapture()):Q.removeEvent(window,"blur",this._fStop),this._isResizable=!1,this._isDragable=!1}}),SELECT_MODE_CTRL=1,SELECT_MODE_SHIFT=2;Q.Table=Q.extend({wndParent:null,wnd:null,wndTitleBar:null,wndFrame:null,wndGroupHeader:null,wndGroupBody:null,wndToolbar:null,wndTableHeaderRow:null,wndTableData:null,wndMoveLine:null,columns:[],evtListener:{},store:null,selected_row:null,__init__:function(t){var e=this;t=t||{},e.title=t.title,e.store=t.store,e.columns=t.columns||[],"function"==typeof t.row_onclick&&(e.row_onclick=t.row_onclick),"function"==typeof t.row_ondblclick&&(e.row_ondblclick=t.row_ondblclick),"function"==typeof t.row_onmouseover&&(e.row_onmouseover=t.row_onmouseover),"function"==typeof t.row_onmouseout&&(e.row_onmouseout=t.row_onmouseout),e.row_ondblclick="function"==typeof t.row_ondblclick?t.row_ondblclick:function(){},e.row_oninsert="function"==typeof t.row_oninsert?t.row_oninsert:function(){},e.wndParent=Q.$(t.id),e.initview(t),e.render(),e.autosize()},initview:function(t){var e=this;if(e.wnd=document.createElement("DIV"),e.wndTitleBar=document.createElement("DIV"),e.wndFrame=document.createElement("DIV"),e.wndGroupHeader=document.createElement("DIV"),e.wndGroupBody=document.createElement("DIV"),e.wndToolbar=document.createElement("DIV"),e.wndMoveLine=document.createElement("DIV"),document.body.appendChild(e.wndMoveLine),e.wnd.appendChild(e.wndTitleBar),e.wnd.appendChild(e.wndFrame),e.wndFrame.appendChild(e.wndGroupHeader),e.wndFrame.appendChild(e.wndGroupBody),e.wnd.appendChild(e.wndToolbar),e.wnd.className="q-table",e.wndTitleBar.className="q-table-titlebar",e.wndFrame.className="q-table-frame",e.wndGroupHeader.className="q-group-header",e.wndGroupBody.className="q-group-body",e.wndToolbar.className="q-table-toolbar",e.wndMoveLine.className="q-table-moveline",e.wndTitleBar.innerText=e.title,e.wndParent.appendChild(e.wnd),e.wndGroupBody.innerHTML=e.wndGroupHeader.innerHTML='<table cellpadding="0" cellspacing="0" border="0"><tbody></tbody></table>',e.wndTableHeaderRow=e.wndGroupHeader.firstChild.insertRow(-1),e.wndTableData=e.wndGroupBody.firstChild,t.wstyle){var n=(t.wstyle+"").replace(/\|+/g," ");Q.addClass(this.wnd,n)}Q.hasClass(this.wnd,"q-attr-toolbar")||(this.wndToolbar.style.display="none"),e.load_columns(),e.wndGroupHeader.onselectstart=function(){return!1},e.wndGroupBody.onscroll=function(){e._sync_scroll()},e.wndGroupBody.onselectstart=function(){return!1}},autosize:function(){{var t,e=this,n=parseInt(e.wndParent.offsetHeight,10);parseInt(e.wndParent.offsetWidth,10),e.wnd.currentStyle}t=n-e.wndTitleBar.offsetHeight-e.wndToolbar.offsetHeight,e.wndFrame.style.height=t+"px",e.wndGroupBody.style.height=t-e.wndGroupHeader.offsetHeight+"px",e.wndGroupHeader.style.width=e.wndGroupBody.scrollWidth+"px"},_sync_scroll:function(){this.wndGroupHeader.style.left=-this.wndGroupBody.scrollLeft+"px",this.sync_scroll()},setStyle:function(t){Q.addClass(this.wnd,t)},removeStyle:function(t){Q.removeClass(this.wnd,t)},append:function(t,e){var n=this,i=n.wndTableData.insertRow(-1);i.onmouseover=function(t,e){return function(){t.row_is_enabled(e)&&(t.row_is_selected(e)||Q.addClass(e,"mouseover"))}}(this,i),i.onmouseout=function(t,e){return function(){t.row_is_enabled(e)&&(t.row_is_selected(e)||Q.removeClass(e,"mouseover"))}}(this,i),i.onclick=function(t,e){return function(){return e.clickonce?(e.clickonce=!1,clearTimeout(e.t),t._rows_ondblclick(e)):(e.clickonce=!0,e.t=setTimeout(function(n){return function(){n.clickonce=!1,t._rows_onclick(e)}}(e),200)),!1}}(this,i),i.setAttribute("__dataindex__",e.__dataindex__),i.data=e;for(var o=n.wndTableHeaderRow.cells.length,s=0;o>s;s++){var r=i.insertCell(-1),d=n.wndTableHeaderRow.cells[s],a=n.columns[d.getAttribute("_index")],u=e[a.name];"function"==typeof a.renderer&&(u=a.renderer(e));var l=a.width,c=n._create_cell(i.rowIndex,s,{content:u,align:a.align,className:a.className,width:l,height:30,isHTML:a.isHTML});r.style.display=d.style.display,r.appendChild(c)}n.row_oninsert(i,e)},_create_cell:function(t,e,n){var i=document.createElement("DIV");return i.className="q-table-cdata",n.className&&(i.className+=" "+n.className),i.align=n.align,i.style.cssText="width:"+n.width+"px; height:"+n.height+"px;line-height: "+n.height+"px;",i.innerHTML=n.content,i},clear:function(){this.store.clear(),this.wndTableData.innerHTML=""},appendData:function(t){this.store.appendData(t)},render:function(){this.store.each(function(t){return function(e,n){t.append(n,e)}}(this))},load_columns:function(){for(var t=0;t<this.columns.length;t++){var e=this.columns[t];e.width=parseInt(e.width,10),this.insert_column(t,e)}},insert_column:function(t,e){var n=this,i=n.wndTableHeaderRow.insertCell(-1);e.isHidden=!!e.isHidden,i.style.display=e.isHidden?"none":"",i.setAttribute("_index",t),i.innerHTML='<DIV align="'+e.align+'" class="q-column-header" style="width:'+e.width+'px;"><a HideFocus>'+e.title+"</a></DIV>",i.firstChild.onclick=function(){n._column_click(this.parentNode.cellIndex)},e.fixed||new __TH(i,{moveline:n.wndMoveLine,onStart:function(t,e){n._column_MouseDown(t,e)},onStop:function(t,e){n._column_MouseUp(t,e)}})},setSortFunc:function(t,e){var n=this,i=n.columns[t];i?i.sort=e:alert("Invalid Column")},_column_MouseDown:function(t,e){var n=this;e._isResizable&&(n.wndMoveLine.style.height=n.wnd.offsetHeight-n.wndTitleBar.offsetHeight+"px")},_column_MouseUp:function(t,e){var n=this,i=e.hwnd;if(e._isResizable){var o=i.cellIndex;n.rows_each(function(t){var n=t.cells[o].childNodes[0];n.style.width=e._width+"px"}),n.autosize(),n._sync_scroll()}},_column_click:function(t){var e=this.columns[t];if(e.sort,e&&e.clicks)for(var n=0;n<e.clicks.length;n++)e.clicks[n]()},_rows_onclick:function(t){var e=this;if(!this.row_is_enabled(t))return!1;if(Q.removeClass(t,"mouseover"),Q.hasClass(this.wnd,"q-attr-multiselect"))e.select_mode==SELECT_MODE_CTRL?e.row_set_selected(t,!e.row_is_selected(t)):e.select_mode==SELECT_MODE_SHIFT||(e.rows_selected.each(function(t,n){e.row_set_selected(e.rows_selected.item(n),!1)}),e.row_set_selected(t,!0));else{if(t==this.selected_row)return!1;this.row_set_selected(t,!0),this.row_set_selected(this.selected_row,!1),this.selected_row=t}e.row_onclick&&e.row_onclick(t)},_rows_ondblclick:function(t){return this.row_is_enabled(t)?void(this.row_ondblclick&&this.row_ondblclick(t)):!1},rows_each:function(t){for(var e=this,n=0;n<e.wndTableData.rows.length;n++)t(e.wndTableData.rows[n])},row_enable:function(){},row_remove:function(t){var e=this,n=e.store.records[e.row_index(t)];e.wndTableData.deleteRow(t.rowIndex),e.store.remove(n),e.autosize()},row_insert:function(t,e){var n=this;n.store.push(e),n.insertrow(t,e),n.autosize()},row_index:function(t){return parseInt(t.getAttribute("__dataindex__"),10)},row_is_enabled:function(t){return t&&!t.getAttribute("_disabled")},row_is_selected:function(t){return Q.hasClass(t,"q-selected")},rows_selected_all:function(t){var e=this;e.rows_each(function(n){e.row_set_selected(n,t)})},row_set_selected:function(t,e){if(this.row_is_enabled(t)){{this.row_index(t)}e?Q.addClass(t,"q-selected"):Q.removeClass(t,"q-selected")}},getRecord:function(t){var e=this.row_index(t);return this.store.records.item(e)},sync_scroll:function(){}}),Q.DropDownList=Q.extend({hwnd:null,drop_wnd:null,ctrl:null,__init__:function(t){var e=this;this.hwnd=document.createElement("BUTTON"),this.hwnd.className="q-select",Q.addClass(this.hwnd,t.wstyle),this.on_change=t.on_change||function(){},this.ctrl=Q.$(t.id),this.ctrl.parentNode.insertBefore(this.hwnd,this.ctrl),this.ctrl.onchange=function(t,e){return function(){Q.printf("ctrl onchage"),t.on_item_changed(e.options[e.selectedIndex].text,e.options[e.selectedIndex].value)}}(this,this.ctrl);var n=new Q.MenuBar;if(this.drop_wnd=new Q.Menu({style:t.wstyle,on_popup:function(t){t?Q.addClass(e.hwnd,"checked"):Q.removeClass(e.hwnd,"checked")}}),"select"==this.ctrl.tagName.toLowerCase())for(var i=this.ctrl.options.length,o=0;i>o;o++){var s=new Q.MenuItem({text:this.ctrl.options[o].text,data:o,callback:Q.bind_handler(e,e.on_menu_clicked)});this.drop_wnd.addMenuItem(s),o==this.ctrl.selectedIndex&&(this.setValue(this.ctrl.options[o].value),this.setText(this.ctrl.options[o].text))}this.drop_wnd.hide(),n.append(this.hwnd,this.drop_wnd),t.value&&this.setValue(t.value)},on_menu_clicked:function(t){Q.printf(t.data);var e=t.data;e!=this.ctrl.selectedIndex&&this.setValue(this.ctrl.options[e].value)},on_item_changed:function(t,e){this.setText(t),this.on_change(t,e)},setText:function(t){return this.trim(this.hwnd.innerText)==this.trim(t)?!1:(this.hwnd.innerText=this.trim(t),!0)},setValue:function(t){for(var e=this.ctrl,n=this.ctrl.selectedIndex,i=0;i<e.options.length;i++)if(e.options[i].value==t){if(n!=i)return e.options[i].selected=!0,this.on_item_changed(e.options[i].text,e.options[i].value),!0;break}return!1},trim:function(t){return t.replace(/&nbsp;/,"")}});